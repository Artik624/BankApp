<!DOCTYPE html>
<html>
    <head>
        
    </head>  
    
    <header>
        <h1>BankApp</h1>
    </header>
        
    <body>
        
        <div class="login-form">
            <form action="" method="post">
                Name: <input name="name" type="text" id="nameInpt" autocomplete="off"> <br>
                Password : <input min="1" name="passwd" id="pswdInpt" autocomplete="off">
            </form>
            <button id="login-btn">Login</button>
            <button id="forgotPswd-btn">Forgot Password</button>
            <button id="register-btn">Register</button>
            <p id="test"></p>
        </div>
        
        <script>
            
            const nameEl = document.getElementById("nameInpt")
            const passEl = document.getElementById("pswdInpt")
            const regBtn = document.getElementById("register-btn")
            const loginBtn = document.getElementById("login-btn")
            const testEl = document.getElementById('test') // @dont forget to change 

             
            loginBtn.addEventListener("click",function(){

                let userName = nameEl.value
                let user = {userName:nameEl.value, pass:passEl.value}
                getUser()

                async function red() {
                        const res = await fetch('/account', {method:'GET'})
                        console.log(res.url)
                        window.location.href = res.url
                    }

                async function getUser(){
                    const response =  await fetch('/user', {
                    method:'POST',
                    headers:{
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(user)
                })
                    const name = await response.json() 
                    if(name[0] != undefined) {
                        testEl.innerHTML= `welcome ${name[0].name}`
                        red()
                        return true
                    }else{
                        testEl.innerHTML= "invalid user or password "
                        return false
                    }                
                }
            })
    

            regBtn.addEventListener('click', () =>{
                (async ()=> {
                    const res = await fetch('/register', {method:'GET'})
                    window.location.href = res.url
                })()
                
            })
            
             

        </script>

    </body>

</html>